(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-476ccb48"],{"0125":function(e,t,n){"use strict";n("7c35")},"102e":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("van-nav-bar",{attrs:{fixed:""},scopedSlots:e._u([{key:"left",fn:function(){return[n("div",{staticClass:"logo"})]},proxy:!0},{key:"right",fn:function(){return[n("van-button",{staticClass:"search-btn",attrs:{round:"",hairline:"",icon:"search",type:"info",size:"small"},on:{click:function(t){return e.$router.push("/search")}}},[e._v(" 搜索 ")])]},proxy:!0}])}),n("van-tabs",{model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[e._l(e.channelList,(function(e){return n("van-tab",{key:+e.id,attrs:{title:e.name}},[n("ArticleList",{ref:"list",refInFor:!0,attrs:{channelId:+e.id}})],1)})),n("div",{staticClass:"bar-btn",on:{click:function(t){e.isShowChannels=!0}}},[n("van-icon",{attrs:{name:"wap-nav"}})],1)],2),n("van-action-sheet",{attrs:{title:"频道管理"},model:{value:e.isShowChannels,callback:function(t){e.isShowChannels=t},expression:"isShowChannels"}},[n("ChannelEdit",{attrs:{isShowChannels:e.isShowChannels},on:{close:function(t){e.isShowChannels=!1}},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}})],1)],1)},a=[],i=n("1da1"),s=n("5530"),c=(n("96cf"),n("159b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"scroll",staticClass:"article-list",on:{scroll:e.scrollFn}},[n("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[n("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[e._l(e.articleList,(function(t){return n("van-cell",{key:t.art_id.toString(),attrs:{title:t.title},on:{click:function(n){e.$router.push("/article/"+t.art_id.toString())}},scopedSlots:e._u([{key:"label",fn:function(){return[n("div",[t.cover.type>0?n("van-grid",{attrs:{border:!1,"column-num":t.cover.type}},e._l(t.cover.images,(function(e,r){return n("van-grid-item",{key:r},[n("van-image",{class:1===t.cover.type?"one":"three",attrs:{"lazy-load":"",src:e,fit:"cover"}})],1)})),1):e._e(),n("div",{staticClass:"meta"},[n("span",[e._v(e._s(t.aut_name))]),n("span",[e._v(e._s(t.comm_count)+"评论")]),n("span",[e._v(e._s(e._f("fromNow")(t.pubdate)))]),e.$store.state.user.token.token?n("span",{staticClass:"close",staticStyle:{float:"right"},on:{click:function(n){return e.showMoreAction(t.art_id)}}},[n("van-icon",{attrs:{name:"cross"}})],1):e._e()])],1)]},proxy:!0}],null,!0)})})),n("van-popup",{style:{width:"60%"},model:{value:e.isShowMoreAction,callback:function(t){e.isShowMoreAction=t},expression:"isShowMoreAction"}},[e.isTop?n("van-cell-group",[n("van-cell",{on:{click:e.dislike}},[e._v("不感兴趣")]),n("van-cell",{attrs:{"is-link":""},on:{click:function(t){e.isTop=!1}}},[e._v("反馈垃圾内容")]),n("van-cell",{on:{click:e.blacklist}},[e._v("拉黑作者")])],1):n("van-cell-group",[n("van-cell",{attrs:{icon:"arrow-left"},on:{click:function(t){e.isTop=!0}}},[e._v("返回")]),e._l(e.reports,(function(t){return n("van-cell",{key:t.value,on:{click:function(n){return e.report(t.value)}}},[e._v(e._s(t.label))])}))],2)],1)],2)],1)],1)}),o=[],l=n("2909"),u=(n("a9e3"),n("99af"),n("d3b7"),n("25f0"),n("4de4"),n("2423")),h=[{value:0,label:"其他问题"},{value:1,label:"标题夸张"},{value:2,label:"低俗色情"},{value:3,label:"错别字多"},{value:4,label:"旧闻重复"},{value:6,label:"内容不实"},{value:5,label:"广告软文"},{value:7,label:"涉嫌违法犯罪"},{value:8,label:"侵权"}],f={props:{channelId:Number},data:function(){return{articleList:[],loading:!1,finished:!1,refreshing:!1,timestamp:Date.now(),isShowMoreAction:!1,isTop:!0,artId:"",reports:h,scrollTop:0}},activated:function(){this.scrollToTop()},methods:{scrollFn:function(){this.scrollTop=this.$refs.scroll.scrollTop},scrollToTop:function(){this.$refs.scroll.scrollTop=this.scrollTop},onLoad:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.refreshing&&(e.articleList=[],e.timestamp=Date.now()),t.next=3,Object(u["i"])(e.channelId,e.timestamp);case 3:n=t.sent,e.timestamp=n.data.pre_timestamp,e.articleList=[].concat(Object(l["a"])(e.articleList),Object(l["a"])(n.data.results)),e.loading=!1,e.refreshing=!1,(0===n.data.results.length||e.articleList.length>100)&&(e.finished=!0);case 9:case"end":return t.stop()}}),t)})))()},onRefresh:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.finished=!1,e.loading=!0,e.onLoad();case 3:case"end":return t.stop()}}),t)})))()},showMoreAction:function(e){this.artId=e.toString(),this.isTop=!0,this.isShowMoreAction=!0},dislike:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["g"])(e.artId);case 2:e.isShowMoreAction=!1,e.$toast.success("操作成功"),e.articleList=e.articleList.filter((function(t){return t.art_id.toString()!==e.artId}));case 5:case"end":return t.stop()}}),t)})))()},report:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(u["m"])(t.artId,e);case 3:t.$toast.success("举报成功"),n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](0),t.$toast.fail("您已经举报过该文章");case 9:t.isShowMoreAction=!1;case 10:case"end":return n.stop()}}),n,null,[[0,6]])})))()},blacklist:function(){this.$toast.success("拉黑成功"),this.isShowMoreAction=!1}}},d=f,p=(n("a005"),n("2877")),v=Object(p["a"])(d,c,o,!1,null,"6fe2043c",null),m=v.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"channel-edit"},[n("div",{staticClass:"channel"},[n("van-cell",{attrs:{center:"",title:"我的频道",border:!1},scopedSlots:e._u([{key:"right-icon",fn:function(){return[n("van-button",{attrs:{plain:"",size:"mini",type:"danger"},on:{click:function(t){e.editing=!e.editing}}},[e._v(e._s(e.editing?"取消":"编辑"))])]},proxy:!0}])}),n("van-grid",e._l(e.channelList,(function(t,r){return n("van-grid-item",{key:t.id,class:{current:e.value===r},on:{click:function(t){return e.changeActive(r)}}},[n("span",[e._v(e._s(t.name))]),n("van-icon",{directives:[{name:"show",rawName:"v-show",value:e.editing&&0!==r,expression:"editing && index !== 0"}],staticClass:"btn",attrs:{name:"cross"},on:{click:function(n){return n.stopPropagation(),e.delChannel(t,r)}}})],1)})),1)],1),n("div",{staticClass:"channel"},[n("van-cell",{attrs:{center:"",title:"可选频道",border:!1}}),n("van-grid",e._l(e.optionalChannelList,(function(t){return n("van-grid-item",{key:t.id,on:{click:function(n){return e.addChannel(t)}}},[n("span",[e._v(e._s(t.name))])])})),1)],1)])},g=[],k=n("2f62"),w=n("6dfa"),_=n("5d2d"),x={data:function(){return{editing:!1}},props:{value:Number,isShowChannels:Boolean},computed:Object(s["a"])(Object(s["a"])({},Object(k["d"])("channel",["channelList"])),Object(k["b"])("channel",["optionalChannelList"])),methods:{changeActive:function(e){if(this.editing)return this.$toast("编辑状态不允许切换");this.$emit("input",e),this.$emit("close")},addChannel:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.$store.commit("channel/addChannel",e),!t.$store.state.user.token.token){n.next=6;break}return n.next=4,Object(w["a"])([{id:e.id,seq:t.channelList.length}]);case 4:n.next=7;break;case 6:Object(_["e"])(t.channelList);case 7:case"end":return n.stop()}}),n)})))()},delChannel:function(e,t){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!(n.channelList.length<=4)){r.next=2;break}return r.abrupt("return",n.$toast("至少保留4个频道"));case 2:if(t<n.value&&n.$emit("input",n.value-1),t===n.value&&n.$emit("input",0),n.$store.commit("channel/delChannel",e),!n.$store.state.user.token.token){r.next=10;break}return r.next=8,Object(w["b"])(e.id);case 8:r.next=11;break;case 10:Object(_["e"])(n.channelList);case 11:case"end":return r.stop()}}),r)})))()}},watch:{isShowChannels:function(e){e||(this.editing=!1)}}},C=x,S=(n("f431"),Object(p["a"])(C,b,g,!1,null,"3e2d7307",null)),L=S.exports,$={name:"Home",components:{ArticleList:m,ChannelEdit:L},data:function(){return{active:0,isShowChannels:!1}},computed:Object(s["a"])({},Object(k["d"])("channel",["channelList"])),created:function(){if(this.$store.dispatch("channel/getAllChannelList"),this.$store.state.user.token.token)this.$store.dispatch("channel/getChannelList");else{var e=Object(_["a"])();e?this.$store.commit("channel/setChannelList",e):this.$store.dispatch("channel/getChannelList")}},watch:{active:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$nextTick();case 2:e.$refs.list.forEach((function(e){e.scrollToTop()}));case 3:case"end":return t.stop()}}),t)})))()}}},O=$,y=(n("0125"),Object(p["a"])(O,r,a,!1,null,"f5911406",null));t["default"]=y.exports},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var r=n("1d80"),a=n("5899"),i="["+a+"]",s=RegExp("^"+i+i+"*"),c=RegExp(i+i+"*$"),o=function(e){return function(t){var n=String(r(t));return 1&e&&(n=n.replace(s,"")),2&e&&(n=n.replace(c,"")),n}};e.exports={start:o(1),end:o(2),trim:o(3)}},7093:function(e,t,n){},7156:function(e,t,n){var r=n("861d"),a=n("d2bb");e.exports=function(e,t,n){var i,s;return a&&"function"==typeof(i=t.constructor)&&i!==n&&r(s=i.prototype)&&s!==n.prototype&&a(e,s),e}},"7c35":function(e,t,n){},"9d0a":function(e,t,n){},a005:function(e,t,n){"use strict";n("9d0a")},a9e3:function(e,t,n){"use strict";var r=n("83ab"),a=n("da84"),i=n("94ca"),s=n("6eeb"),c=n("5135"),o=n("c6b6"),l=n("7156"),u=n("c04e"),h=n("d039"),f=n("7c73"),d=n("241c").f,p=n("06cf").f,v=n("9bf2").f,m=n("58a8").trim,b="Number",g=a[b],k=g.prototype,w=o(f(k))==b,_=function(e){var t,n,r,a,i,s,c,o,l=u(e,!1);if("string"==typeof l&&l.length>2)if(l=m(l),t=l.charCodeAt(0),43===t||45===t){if(n=l.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+l}for(i=l.slice(2),s=i.length,c=0;c<s;c++)if(o=i.charCodeAt(c),o<48||o>a)return NaN;return parseInt(i,r)}return+l};if(i(b,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var x,C=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof C&&(w?h((function(){k.valueOf.call(n)})):o(n)!=b)?l(new g(_(t)),n,C):_(t)},S=r?d(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),L=0;S.length>L;L++)c(g,x=S[L])&&!c(C,x)&&v(C,x,p(g,x));C.prototype=k,k.constructor=C,s(a,b,C)}},f431:function(e,t,n){"use strict";n("7093")}}]);
//# sourceMappingURL=chunk-476ccb48.14ccdfb7.js.map